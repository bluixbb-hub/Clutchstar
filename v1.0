@echo off
title i5-750 & GTX 750Ti Ultimate Optimizer
color 0b
echo ====================================================
echo      MAXIMUM PERFORMANCE SCRIPT (Source: Exm)
echo      Optimizing for: i5-750 / GTX 750 Ti
echo ====================================================
echo.

:: 1. CHECK FOR ADMIN
net session >nul 2>&1
if %errorLevel% == 0 (
    echo [OK] Running as Administrator
) else (
    echo [ERROR] Please Run as Administrator!
    pause
    exit
)

:: 2. CREATE RESTORE POINT [Source: 7, 16]
echo Creating System Restore Point...
powershell -Command "Checkpoint-Computer -Description 'Pre-Optimization' -RestorePointType 'MODIFY_SETTINGS'"
echo.

:: 3. WINDOWS VISUALS & GAMING [Source: 89, 91, 137]
echo Disabling Transparency and GameDVR...
Reg.exe add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize" /v "EnableTransparency" /t REG_DWORD /d "0" /f
Reg.exe add "HKCU\SOFTWARE\Microsoft\GameBar" /v "AllowAutoGameMode" /t REG_DWORD /d "1" /f
Reg.exe add "HKCU\System\GameConfigStore" /v "GameDVR_Enabled" /t REG_DWORD /d "0" /f
Reg.exe add "HKLM\Software\Policies\Microsoft\Windows\GameDVR" /v "AllowgameDVR" /t REG_DWORD /d "0" /f

:: 4. DISABLE BACKGROUND APPS [Source: 87]
echo Killing Background Apps to save CPU...
Reg.exe add "HKCU\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v "GlobalUserDisabled" /t REG_DWORD /d "1" /f
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\bam" /v "Start" /t REG_DWORD /d "4" /f

:: 5. NETWORK OPTIMIZATION (Nagle's Algorithm) [Source: 276, 278]
echo Optimizing Network Latency (TCPNoDelay)...
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces" /v "TcpAckFrequency" /t REG_DWORD /d "1" /f
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces" /v "TCPNoDelay" /t REG_DWORD /d "1" /f
Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v "NetworkThrottlingIndex" /t REG_DWORD /d "4294967295" /f

:: 6. CPU & SYSTEM RESPONSIVENESS [Source: 291, 280]
echo Tuning CPU Priority for Games...
Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v "SystemResponsiveness" /t REG_DWORD /d "0" /f
Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "GPU Priority" /t REG_DWORD /d "18" /f
Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "Priority" /t REG_DWORD /d "6" /f
Reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "Scheduling Category" /t REG_SZ /d "High" /f

:: 7. DISABLE CPU SECURITY MITIGATIONS (Huge boost for i5-750) [Source: 282]
echo Disabling Spectre/Meltdown Mitigations (Performance Boost)...
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettings" /t REG_DWORD /d "1" /f
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverride" /t REG_DWORD /d "3" /f
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "FeatureSettingsOverrideMask" /t REG_DWORD /d "3" /f

:: 8. MEMORY MANAGEMENT (For 12GB RAM) [Source: 284, 337]
echo Optimizing RAM Management...
:: Disables paging executive (keeps kernel in RAM)
Reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "DisablePagingExecutive" /t REG_DWORD /d "1" /f
:: Disables Superfetch (SysMain) - often helps older CPUs
sc stop SysMain
sc config SysMain start= disabled

:: 9. POWER SETTINGS (High Perf)
echo Forcing High Performance Power Plan...
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61
powercfg -setactive e9a42b02-d5df-448d-aa00-03f14749eb61

:: 10. DEBLOAT (Removing Useless Apps) [Source: 171-185]
echo Removing Bloatware (Bing, Maps, People, Xbox)...
powershell -Command "Get-AppxPackage *BingWeather* | Remove-AppxPackage"
powershell -Command "Get-AppxPackage *Microsoft.People* | Remove-AppxPackage"
powershell -Command "Get-AppxPackage *WindowsMaps* | Remove-AppxPackage"
powershell -Command "Get-AppxPackage *ZuneMusic* | Remove-AppxPackage"
powershell -Command "Get-AppxPackage *ZuneVideo* | Remove-AppxPackage"
powershell -Command "Get-AppxPackage *Microsoft.XboxApp* | Remove-AppxPackage"
powershell -Command "Get-AppxPackage *Microsoft.YourPhone* | Remove-AppxPackage"

:: 11. CLEANUP [Source: 398]
echo Cleaning Temp Files...
del /s /f /q %temp%\*.*
del /s /f /q C:\Windows\Temp\*.*

echo.
echo ====================================================
echo      OPTIMIZATION COMPLETE. RESTART YOUR PC!
echo ====================================================
pause
